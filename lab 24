import pandas as pd
from sklearn.feature_selection import VarianceThreshold
from sklearn.linear_model import LinearRegression

df = pd.read_csv(r"C:\Users\Admin\Downloads\data_day24_selection (1).csv")

X = df.drop("target", axis=1)
y = df["target"]

selector = VarianceThreshold(threshold=0.01)
X_var = selector.fit_transform(X)

cols_after_var = X.columns[selector.get_support()]
X_var = pd.DataFrame(X_var, columns=cols_after_var)

corr_matrix = X_var.corr().abs()

to_drop = set()
for i in range(len(corr_matrix.columns)):
    for j in range(i):
        if corr_matrix.iloc[i, j] > 0.9:
            colname = corr_matrix.columns[i]
            to_drop.add(colname)

X_selected = X_var.drop(columns=to_drop)


model1 = LinearRegression()
model1.fit(X, y)
print("Before selection R2:", model1.score(X, y))

model2 = LinearRegression()
model2.fit(X_selected, y)
print("After selection R2:", model2.score(X_selected, y))
